<!-- pages/feedback/feedback.wxml -->
<view class="feedback-page">
  <view class="feedback-header">
    <text class="page-title">📝 意见反馈</text>
  </view>

  <view class="feedback-form">
    <view class="form-section">
      <view class="section-title">
        <text class="required">*</text>
        <text>反馈类型</text>
      </view>
      <view class="type-options">
        <view 
          class="type-item {{feedbackType === 'suggestion' ? 'active' : ''}}" 
          bindtap="selectType" 
          data-type="suggestion"
        >
          <text class="type-icon">💡</text>
          <text class="type-text">功能建议</text>
        </view>
        <view 
          class="type-item {{feedbackType === 'bug' ? 'active' : ''}}" 
          bindtap="selectType" 
          data-type="bug"
        >
          <text class="type-icon">🐛</text>
          <text class="type-text">问题反馈</text>
        </view>
        <view 
          class="type-item {{feedbackType === 'complaint' ? 'active' : ''}}" 
          bindtap="selectType" 
          data-type="complaint"
        >
          <text class="type-icon">📢</text>
          <text class="type-text">投诉建议</text>
        </view>
        <view 
          class="type-item {{feedbackType === 'other' ? 'active' : ''}}" 
          bindtap="selectType" 
          data-type="other"
        >
          <text class="type-icon">📋</text>
          <text class="type-text">其他</text>
        </view>
      </view>
    </view>

    <view class="form-section">
      <view class="section-title">
        <text class="required">*</text>
        <text>问题描述</text>
      </view>
      <textarea 
        class="feedback-textarea" 
        placeholder="请详细描述您的问题或建议，至少10个字..."
        placeholder-class="input-placeholder"
        value="{{content}}"
        bindinput="onContentInput"
        maxlength="500"
      />
      <view class="word-count">
        <text>{{content.length}}/500</text>
      </view>
    </view>

    <view class="form-section">
      <view class="section-title">
        <text class="required">*</text>
        <text>联系方式</text>
      </view>
      <input 
        class="feedback-input" 
        value="{{contact}}"
        bindinput="onContactInput"
      />
    </view>

    <view class="form-section">
      <view class="section-title">
        <text>上传图片</text>
        <text class="optional">(选填，最多3张)</text>
      </view>
      <view class="image-upload">
        <block wx:for="{{images}}" wx:key="index">
          <view class="image-item">
            <image src="{{item}}" mode="aspectFill" class="preview-image" />
            <view class="delete-btn" bindtap="deleteImage" data-index="{{index}}">✕</view>
          </view>
        </block>
        <view class="upload-btn" wx:if="{{images.length < 3}}" bindtap="chooseImage">
          <text class="upload-icon">+</text>
          <text class="upload-text">添加图片</text>
        </view>
      </view>
    </view>

    <button class="submit-btn {{canSubmit ? '' : 'disabled'}}" bindtap="submitFeedback" disabled="{{!canSubmit || submitting}}">
      {{submitting ? '提交中...' : '提交反馈'}}
    </button>
  </view>

  <view class="feedback-tips">
    <text class="tips-title">温馨提示</text>
    <text class="tips-item">• 我们会在1-3个工作日内处理您的反馈</text>
    <text class="tips-item">• 请确保联系方式正确，以便我们及时回复</text>
    <text class="tips-item">• 感谢您的宝贵意见，我们会不断改进</text>
  </view>
</view>

<view class="success-modal" wx:if="{{showSuccess}}">
  <view class="modal-content">
    <text class="success-icon">✅</text>
    <text class="success-title">提交成功</text>
    <text class="success-text">感谢您的反馈，我们会尽快处理</text>
    <button class="success-btn" bindtap="closeSuccessModal">确定</button>
  </view>
</view>
