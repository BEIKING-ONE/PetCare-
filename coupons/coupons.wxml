<!-- pages/coupons/coupons.wxml -->
<view class="coupons-page">
  <!-- ä¼˜æƒ åˆ¸å¤´éƒ¨ -->
  <view class="coupons-header">
    <text class="page-title">ğŸ« æˆ‘çš„ä¼˜æƒ åˆ¸</text>
  </view>

  <!-- ä¼˜æƒ åˆ¸æ ‡ç­¾ -->
  <scroll-view class="coupon-tabs" scroll-x>
    <text 
      class="tab-item {{activeTab === 'all' ? 'active' : ''}}"
      bindtap="switchTab"
      data-tab="all"
    >
      ğŸ“‹ å…¨éƒ¨
    </text>
    <text 
      class="tab-item {{activeTab === 'available' ? 'active' : ''}}"
      bindtap="switchTab"
      data-tab="available"
    >
      ğŸ å¯ä½¿ç”¨
    </text>
    <text 
      class="tab-item {{activeTab === 'expired' ? 'active' : ''}}"
      bindtap="switchTab"
      data-tab="expired"
    >
      â° å·²è¿‡æœŸ
    </text>
  </scroll-view>

  <!-- ä¼˜æƒ åˆ¸åˆ—è¡¨ -->
  <view class="coupon-list">
    <block wx:for="{{coupons}}" wx:key="id">
      <view class="coupon-card {{item.status}}">
        <!-- ä¼˜æƒ åˆ¸é‡‘é¢ -->
        <view class="coupon-amount">
          <text class="currency">Â¥</text>
          <text class="amount">{{item.amount}}</text>
        </view>

        <!-- ä¼˜æƒ åˆ¸ä¿¡æ¯ -->
        <view class="coupon-info">
          <text class="coupon-name">{{item.name}}</text>
          <text class="coupon-desc">{{item.description}}</text>
          <text class="coupon-expire">æœ‰æ•ˆæœŸè‡³ {{formatTime(item.expireTime)}}</text>
        </view>

        <!-- ä¼˜æƒ åˆ¸æ“ä½œ -->
        <view class="coupon-actions" wx:if="{{item.status === 'available'}}">
          <text class="action-btn" bindtap="useCoupon" data-id="{{item.id}}">ç«‹å³ä½¿ç”¨</text>
        </view>
        <view class="coupon-actions" wx:if="{{item.status === 'expired'}}">
          <text class="action-btn expired">å·²è¿‡æœŸ</text>
        </view>
      </view>
    </block>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:if="{{coupons.length === 0}}">
    <text class="empty-icon">ğŸ«</text>
    <text class="empty-text">æš‚æ— ä¼˜æƒ åˆ¸</text>
    <text class="empty-tip">å»å•†åŸé€›é€›å§ï½</text>
    <button class="go-shop-btn" bindtap="goToShop">å»å•†åŸ</button>
  </view>
</view>